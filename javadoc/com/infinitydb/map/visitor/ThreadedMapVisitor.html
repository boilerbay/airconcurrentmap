<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_65) on Sat Apr 08 14:44:48 PDT 2017 -->
<title>ThreadedMapVisitor</title>
<meta name="date" content="2017-04-08">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ThreadedMapVisitor";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/infinitydb/map/visitor/RemoteMapVisitor.html" title="class in com.infinitydb.map.visitor"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/infinitydb/map/visitor/Visitable.html" title="class in com.infinitydb.map.visitor"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/infinitydb/map/visitor/ThreadedMapVisitor.html" target="_top">Frames</a></li>
<li><a href="ThreadedMapVisitor.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.infinitydb.map.visitor</div>
<h2 title="Class ThreadedMapVisitor" class="title">Class ThreadedMapVisitor&lt;K,V&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../../com/infinitydb/map/visitor/MapVisitor.html" title="class in com.infinitydb.map.visitor">com.infinitydb.map.visitor.MapVisitor</a>&lt;K,V&gt;</li>
<li>
<ul class="inheritance">
<li>com.infinitydb.map.visitor.ThreadedMapVisitor&lt;K,V&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../com/infinitydb/map/lambda/CollectingThreadedMapVisitor.html" title="class in com.infinitydb.map.lambda">CollectingThreadedMapVisitor</a>, <a href="../../../../com/infinitydb/map/visitor/RemoteMapVisitor.html" title="class in com.infinitydb.map.visitor">RemoteMapVisitor</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <span class="typeNameLabel">ThreadedMapVisitor&lt;K,V&gt;</span>
extends <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html" title="class in com.infinitydb.map.visitor">MapVisitor</a>&lt;K,V&gt;</pre>
<div class="block">Scan in parallel when used with parallel-capable <a href="../../../../com/infinitydb/map/visitor/Visitable.html" title="class in com.infinitydb.map.visitor"><code>Visitable</code></a>.
 <p>
 A ThreadedMapVisitor is usually provided to the VisitableMap via the idiom
 <code>visitableMap.getVisitable().visit(threadedMapVisitor);</code>.
 <p>
 If the VisitableMap so chooses, a scan will be performed using multiple
 internal threads, with the Threads seeing disjoint sets of K/V pairs, in
 order with respect to each Thread if the VisitableMap provides ordering and
 <a href="../../../../com/infinitydb/map/visitor/Visitable.html#isThreadingAllowed--"><code>Visitable.isThreadingAllowed()</code></a> is true.
 <p>
 The <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-V-"><code>MapVisitor.visit(Object, Object)</code></a> method will be called once per
 key/value Entry, and sometimes <a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html#split--"><code>split()</code></a> and
 <a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html#merge-com.infinitydb.map.visitor.ThreadedMapVisitor-"><code>merge(ThreadedMapVisitor)</code></a> also as chosen by the VisitableMap.
 <p>
 The
 <code>visit(Object, Object), split(), and merge(ThreadedMapVisitor)</code>
 methods will not be invoked concurrently - in other words, it is as if they
 each were synchronized, but there is no need to add synchronization by the
 ThreadedMapVisitor.
 <p>
 The Map may choose to implement the parallel scan using one thread or any
 number of threads, and can change the scheduling and visitor structure at any
 time for best performance. The Map-implementation-specific threads are hidden
 inside the Map, and may be created the first time a threaded visitation is
 requested if the Map chooses. After that they may or may not stop depending
 on exposed Map-specific thread control features. It is not guaranteed that
 multiple threads will be used - for example, small maps may typically bypass
 the multi-threading. It is not guaranteed that different concurrent requests
 for individual threaded visitings coming in to any two or more VisitableMaps
 will be overlapped concurrently with respect to each other. For example, if
 necessary, the entire Map may be locked temporarily for writing.
 <p>
 Visiting is faster partially because there is only one call to
 visit(key,value) per Entry rather than two as in an Iterator. The Java 8
 Spliterator scheme for the Java 8 streams instead has more overhead also, and
 it is a further burden on all Map implementers. Spliterators are also Java 8
 specific, so a Map implementation that wishes to provide Spliterators has to
 come in a Java 8 specific flavor and a pre-Java-8 flavor. This
 ThreadedMapVisitor comes in only one flavor, and there is only one flavor
 instead of three for keys, entries, and values. All of the regular Iterators
 are still available, however. Any Map which wishes to avoid the burden of
 providing the VisitableMap functionality can just not implement it, but such
 a Map can still be visited using <a href="../../../../com/infinitydb/map/visitor/VisitableMapWrapper.html" title="class in com.infinitydb.map.visitor"><code>VisitableMapWrapper</code></a> adapter.
 <p>
 Scheduling can be done efficiently - in AirConcurrentMap the scheduling is
 better than the Java 8 parallel streams feature, and the performance is far
 better over the whole spectrum of Map sizes. It is important that the
 scheduling prevent there being some straggler threads that slow the
 visitation as a whole. A Map-specific thread pool can schedule in an
 implementation-specific way for best results. The straggler threads can be
 reduced to some extent by keeping the threads busy with relatively small
 chunks of work and by work stealing, but it is still difficult to avoid
 stragglers. AirConcurrentMap can usually avoid stragglers and use other
 Map-specific optimizations.
 <p>
 Also, with an iterator, concurrent Map modification produces inconsistent
 results if for example an Entry is removed and the hasNext() believes that it
 does exist, but in-between, next() sees it having been removed and it throws
 NoSuchElementException . A visit(key,value) always consistent and atomic and
 does not throw NoSuchElementException.
 <p>
 Some general performance advice for threaded systems: It is best to avoid the
 <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-V-"><code>MapVisitor.visit(Object, Object)</code></a> touching shared Atomic variables or
 other objects which contain locks or other internal serialization, as they
 may interfere with the ability of the cores to execute independently and may
 cause momentary (invisible) bus locks. Also, synchronization might be
 expected to be fast, be even when the lock is not contended for, there
 can be a significant slowdown. Local fields and variables are best,
 and whether they are private, protected, public, or package accessible does
 not matter, nor does their being final. Volatile fields cause a slowdown, but
 very much less than Atomics - almost negligible. Such effects will be
 significant only in the most performance-critical situations. Also, while
 collecting data into a result Map, non-concurrent Maps may be used if each
 map is local to each visitor instance, and the merge deals with combining
 them in pairs. Alternatively, a shared ConcurrentMap can be used across
 split-off visitor instances, so there will be no merge necessary. A hybrid
 approach is even possible. Which technique to use is a matter of taste and
 desired performance.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Roger</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/infinitydb/map/visitor/MapVisitor.html" title="class in com.infinitydb.map.visitor"><code>MapVisitor</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/RemoteMapVisitor.html" title="class in com.infinitydb.map.visitor"><code>RemoteMapVisitor</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/Visitable.html" title="class in com.infinitydb.map.visitor"><code>Visitable</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/VisitableMap.html" title="interface in com.infinitydb.map.visitor"><code>VisitableMap</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/VisitableMapWrapper.html" title="class in com.infinitydb.map.visitor"><code>VisitableMapWrapper</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/VisitableSetWrapper.html" title="class in com.infinitydb.map.visitor"><code>VisitableSetWrapper</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/VisitableListWrapper.html" title="class in com.infinitydb.map.visitor"><code>VisitableListWrapper</code></a>, 
<a href="../../../../com/infinitydb/map/visitor/VisitableArrayWrapper.html" title="class in com.infinitydb.map.visitor"><code>VisitableArrayWrapper</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html#ThreadedMapVisitor--">ThreadedMapVisitor</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html#merge-com.infinitydb.map.visitor.ThreadedMapVisitor-">merge</a></span>(<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="class in com.infinitydb.map.visitor">ThreadedMapVisitor</a>&lt;<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">K</a>,<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">V</a>&gt;&nbsp;visitor)</code>
<div class="block">Merge two visitors together.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>abstract <a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="class in com.infinitydb.map.visitor">ThreadedMapVisitor</a>&lt;<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">K</a>,<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">V</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html#split--">split</a></span>()</code>
<div class="block">Create a new Visitor from this one.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.infinitydb.map.visitor.MapVisitor">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.infinitydb.map.visitor.<a href="../../../../com/infinitydb/map/visitor/MapVisitor.html" title="class in com.infinitydb.map.visitor">MapVisitor</a></h3>
<code><a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-boolean-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-double-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-float-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-long-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-K-V-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-long-boolean-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-long-double-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-long-float-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-long-long-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-long-V-">visit</a>, <a href="../../../../com/infinitydb/map/visitor/MapVisitor.html#visit-com.infinitydb.map.visitor.VisitableMap-">visit</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ThreadedMapVisitor--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ThreadedMapVisitor</h4>
<pre>public&nbsp;ThreadedMapVisitor()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="split--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>split</h4>
<pre>public abstract&nbsp;<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="class in com.infinitydb.map.visitor">ThreadedMapVisitor</a>&lt;<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">K</a>,<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">V</a>&gt;&nbsp;split()</pre>
<div class="block">Create a new Visitor from this one. This may require transferring some
 state from the current one to the new one. Visitors may be split during
 the work of the threads in the thread pool for the Map. Eventually, all
 of the split-off Visitors are merged together. This is not called by
 multiple threads at once. There is no guarantee that the VisitableMap
 will invoke this at all, and it may choose to do the splitting in any way
 it chooses. The new ThreadedMapVisitor may be used by a different thread
 than the one that invokes split.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A new ThreadedMapVisitor for the threaded visitation to use in a
         new thread until it is merged back to the original.</dd>
</dl>
</li>
</ul>
<a name="merge-com.infinitydb.map.visitor.ThreadedMapVisitor-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>merge</h4>
<pre>public abstract&nbsp;void&nbsp;merge(<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="class in com.infinitydb.map.visitor">ThreadedMapVisitor</a>&lt;<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">K</a>,<a href="../../../../com/infinitydb/map/visitor/ThreadedMapVisitor.html" title="type parameter in ThreadedMapVisitor">V</a>&gt;&nbsp;visitor)</pre>
<div class="block">Merge two visitors together. Only one thread will call this at a time.
 The original Visitor, provided to the VisitableMap, will eventually be
 merged with all of the ones that have been split off. The merges are not
 guaranteed to happen in any pattern, so the threads are free to do splits
 and merges in any way desired.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>visitor</code> - the source of the state to be merged into this visitor.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/infinitydb/map/visitor/RemoteMapVisitor.html" title="class in com.infinitydb.map.visitor"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/infinitydb/map/visitor/Visitable.html" title="class in com.infinitydb.map.visitor"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/infinitydb/map/visitor/ThreadedMapVisitor.html" target="_top">Frames</a></li>
<li><a href="ThreadedMapVisitor.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright (C) 2016 Roger Deran.</small></p>
</body>
</html>
